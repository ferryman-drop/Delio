# ü©∫ TASK-010: –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ü—É–ª—å—Å—É (Heartbeat)

## üéØ –ú–µ—Ç–∞
–ù–∞–¥–∞—Ç–∏ AI-–∞—Å–∏—Å—Ç–µ–Ω—Ç—É –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ "–ø—Ä–æ–∫–∏–¥–∞—Ç–∏—Å—è", –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Ä–æ–∑–º–æ–≤—É, —è–∫—â–æ —Ü–µ –¥–æ—Ä–µ—á–Ω–æ (–Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è, –º–æ—Ç–∏–≤–∞—Ü—ñ—è), –∞–±–æ –∑–∞–ª–∏—à–∞—Ç–∏—Å—è "—Ç–∏—Ö–∏–º", —è–∫—â–æ –Ω—ñ—á–æ–≥–æ –≤–∞–∂–ª–∏–≤–æ–≥–æ –Ω–µ–º–∞—î.

## ‚öôÔ∏è –î–µ—Ç–∞–ª—ñ –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### 1. –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ (`scheduler.py`)
- **–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ê–∫—Ç–∏–≤–Ω–∏—Ö –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**: –ó–∞–º—ñ—Å—Ç—å —Ö–∞—Ä–¥–∫–æ–¥—É `user_id=0`, —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä —Å–∫–∞–Ω—É—î `chat_history.db` –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 48 –≥–æ–¥–∏–Ω.
- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –°—Ç–∞–Ω—É**: –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è `StateGuard`. –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–π–Ω—è—Ç–∏–π (`BUSY` - –¥—ñ—î/–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î), –ø—É–ª—å—Å –ø—Ä–æ–ø—É—Å–∫–∞—î—Ç—å—Å—è, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤.
- **–Ü–Ω—Ç–µ—Ä–≤–∞–ª**: –ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `HEARTBEAT_INTERVAL_MINUTES` –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó (–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 30 —Ö–≤).

### 2. –õ–æ–≥—ñ–∫–∞ –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è (`states/plan.py`)
- **–ü—Ä–æ–º–ø—Ç –ü—É–ª—å—Å—É**: –í —Å–∏—Å—Ç–µ–º–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é –¥–æ–¥–∞–Ω–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –±–ª–æ–∫ "Heartbeat Context" –¥–ª—è –ø–æ–¥—ñ–π —Ç–∏–ø—É `heartbeat`.
- **–ü—Ä–æ—Ç–æ–∫–æ–ª SKIP**: LLM –æ—Ç—Ä–∏–º–∞–ª–∞ –ø—Ä—è–º—É –≤–∫–∞–∑—ñ–≤–∫—É –≤–∏–¥–∞–≤–∞—Ç–∏ `SKIP`, —è–∫—â–æ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –¥—ñ–π –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ (–ü—Ä–∏–Ω—Ü–∏–ø "–¢–∏—à–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º").

### 3. –§—ñ–ª—å—Ç—Ä–∏ (`states/decide.py`)
- **–û–±—Ä–æ–±–∫–∞ SKIP**: –Ø–∫—â–æ –º–æ–¥–µ–ª—å –≤–∏–¥–∞—î "SKIP", —Å—Ç–∞–Ω `DECIDE` –æ–¥—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ `IDLE`, –ª–æ–≥—É—é—á–∏ –ø–æ–¥—ñ—é "Heartbeat SKIPPED".
- **–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –Ø–∫—â–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ —Ä–µ–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ `RESPOND` (–∞–±–æ `ACT`, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏).

## üß™ –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- **–¢–µ—Å—Ç–æ–≤–∏–π –°–∫—Ä–∏–ø—Ç**: –°—Ç–≤–æ—Ä–µ–Ω–æ `scripts/force_heartbeat.py` –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó –ø–æ–¥—ñ—ó –ø—É–ª—å—Å—É.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
    - –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ —É—Å–ø—ñ—à–Ω–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞–≤ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
    - FSM –∑–∞–ø—É—â–µ–Ω–æ –∑ —Ç–∏–ø–æ–º `type="heartbeat"`.
    - –õ–æ–≥–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (—ñ –ø–µ—Ä–µ—Ö—ñ–¥ –≤ SKIP, —ñ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è).

## üîú –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
–§—É–Ω–∫—Ü—ñ—è "Heartbeat" –∞–∫—Ç–∏–≤–Ω–∞ —ñ –∑–∞–ø—É—Å–∫–∞—Ç–∏–º–µ—Ç—å—Å—è –∫–æ–∂–Ω—ñ 30 —Ö–≤–∏–ª–∏–Ω –¥–ª—è –≤—Å—ñ—Ö –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
–î–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—Ç–æ—Ç–∏ –∑–º—ñ–Ω—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `HEARTBEAT_INTERVAL_MINUTES` —É `.env`.
